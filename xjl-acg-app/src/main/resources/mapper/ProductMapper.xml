<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.xjlacgapp.mapper.ProductMapper">
    <select id="findAll" resultType="com.example.xjlacgapp.pojo.Product">
        select * from acg_product wherh state='0' order by apv desc
    </select>
    <select id="findById" resultType="com.example.xjlacgapp.pojo.Product">
        select * from acg_product where id = #{id}
    </select>
    <select id="findById2" resultType="com.example.xjlacgapp.pojo.Product">
        select * from acg_product where id = #{id} and state='0'
    </select>
    <select id="findById3" resultType="com.example.xjlacgapp.pojo.Product">
        select * from acg_product where id = #{id} and state='1'
    </select>
    <select id="findByProductId" resultType="com.example.xjlacgapp.pojo.Product">
        select * from acg_product where productid = #{productid}
    </select>
    <select id="findByType" resultType="com.example.xjlacgapp.pojo.Product">
        select * from acg_product where type = #{type} and id = #{id} and state='0' order by apv desc
    </select>
    <select id="findType" resultType="com.example.xjlacgapp.pojo.Product">
        SELECT type FROM acg_product where id = #{id} and state='0' GROUP BY type
    </select>
    <select id="findByProduct" resultType="com.example.xjlacgapp.pojo.Product">
        select * from acg_product where product like '%'+#{product}+'%' and id = #{id} and state='0'
    </select>
    <select id="findByProduct2" resultType="com.example.xjlacgapp.pojo.Product">
     select top ${pageSize} o.* from (select row_number() over(order by apv desc) as rownumber,* from(select * from acg_product
     where  state = '0' AND product like '%'+#{name}+'%' or state = '0' and  username like '%'+#{name}+'%'
     or state = '0' and type like '%'+#{name}+'%' or state = '0'
     and title like '%'+#{name}+'%' or state = '0' and username like '%'+#{name}+'%') as oo)
     as o where rownumber > #{currentPage};
    </select>
    <select id="findByProduct3" resultType="com.example.xjlacgapp.pojo.Product">
        select * from acg_product where product like '%'+#{product}+'%' and id = #{id} and state='1' or productid like '%'+#{product}+'%' and id = #{id} and state='1'
    </select>
    <select id="findByType2" resultType="com.example.xjlacgapp.pojo.Product">
        select * from acg_product where type = #{type} and state='0' order by apv desc
    </select>
    <select id="findType2" resultType="com.example.xjlacgapp.pojo.Product">
        SELECT type FROM acg_product where  state='0' GROUP BY type
    </select>
    <select id="findTotal" resultType="com.example.xjlacgapp.pojo.Product">
        select count(*)id FROM acg_product where product like '%'+#{name}+'%' and state='0' or username like '%'+#{name}+'%' and state='0' or type like '%'+#{name}+'%' and state='0' or title like '%'+#{name}+'%' and state='0'
    </select>
    <select id="findDelete" resultType="com.example.xjlacgapp.pojo.Product">
        select productid from acg_product where state = '1' group by productid
    </select>
    <insert id="addProduct" parameterType="com.example.xjlacgapp.pojo.Product">
        insert into acg_product values (#{id},#{product},#{title},#{content},#{apv},#{img},#{type},#{amount},#{productid},#{price},#{stock},#{username},#{state})
    </insert>
    <update id="updateProduct" parameterType="com.example.xjlacgapp.pojo.Product">
        update acg_product set product = #{product},title = #{title},content = #{content},type = #{type},price = #{price} where productid = #{productid}
    </update>
    <update id="updateImg" parameterType="com.example.xjlacgapp.pojo.Product">
        update acg_product set img = #{img} where productid = #{productid}
    </update>
    <update id="updateapv" parameterType="com.example.xjlacgapp.pojo.Product">
        update acg_product set apv = #{apv} where productid = #{productid}
    </update>
    <update id="updateStock" parameterType="com.example.xjlacgapp.pojo.Product">
        update acg_product set stock = #{stock}, amount = #{amount} where productid = #{productid}
    </update>
    <update id="updateStock2" parameterType="com.example.xjlacgapp.pojo.Product">
        update acg_product set stock = #{stock} where productid = #{productid}
    </update>
    <update id="deleteByProduct" parameterType="com.example.xjlacgapp.pojo.Product">
        update acg_product set state = '1' where productid = #{productid}
    </update>
    <update id="RecoveryProduct" parameterType="com.example.xjlacgapp.pojo.Product">
        update acg_product set state = '0' where productid = #{productid}
    </update>
</mapper>